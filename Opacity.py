from scipy.interpolate import interp2d
import numpy as np

# Rosseland opacity table imported from 1991ApJS,76:759-801

LogRho = [-9.0,-8.0,-7.0,-6.0,-5.0,-4.0,-3.0,-2.0,-1.0,0.0,1.0,2.0,2.7]
Temperature = [1000.0,1250.0,1500.0,1750.0,2000.0,2250.0,2500.0,2750.0,3000.0,3250.0,3500.0,3750.0,4000.0,4250.0,4500.0,4750.0,5000.0,5250.0,5500.0,5750.0,6000.0,6250.0,6500.0,6750.0,7000.0]
z = np.array([[6.24e-9,2.28e-8,7.53e-8,2.07e-7,7.60e-7,5.21e-6,3.75e-5,2.35e-4,1.79e-3,1.41e-2,1.21e-1,2.07,9.69e1],
    [1.15e-8,4.00e-8,1.25e-7,3.45e-7,1.46e-6,8.90e-6,4.10e-5,1.91e-4,1.11e-3,6.03e-3,4.19e-2,4.37e-1,1.17e1] ,
    [1.87e-8,6.34e-8,1.94e-7,5.38e-7,2.31e-6,1.09e-5,3.65e-5,1.45e-4,6.26e-4,2.72e-3,1.52e-2,9.90e-2,1.59]   ,
    [2.37e-8,8.73e-8,2.77e-7,7.82e-7,3.21e-6,1.20e-5,3.32e-5,1.16e-4,3.94e-4,1.50e-3,6.69e-3,3.16e-2,3.47e-1],
    [2.57e-8,8.56e-8,3.41e-7,1.11e-6,4.40e-6,1.34e-5,3.32e-5,1.00e-4,2.85e-4,9.80e-4,3.58e-3,1.37e-2,1.15e-1],
    [7.40e-8,9.48e-8,2.81e-7,1.21e-6,5.09e-6,1.43e-5,3.32e-5,8.95e-5,2.26e-4,7.12e-4,2.21e-3,7.30e-3,5.14e-2],
    [2.16e-7,2.39e-7,3.13e-7,9.57e-7,5.20e-6,1.56e-5,3.46e-5,8.42e-5,1.95e-4,5.62e-4,1.54e-3,4.59e-3,2.84e-2],
    [6.00e-7,5.93e-7,7.17e-7,9.99e-7,4.23e-6,1.66e-5,3.67e-5,8.26e-5,1.80e-4,4.78e-4,1.19e-3,3.34e-3,1.87e-2],
    [1.62e-6,1.37e-6,1.62e-6,2.13e-6,3.83e-6,1.73e-5,4.20e-5,9.09e-5,1.90e-4,4.65e-4,1.11e-3,3.11e-3,1.55e-2],
    [4.31e-6,3.26e-6,3.52e-6,4.70e-6,7.12e-6,1.98e-5,6.11e-5,1.40e-4,3.01e-4,6.78e-4,1.66e-3,4.82e-3,1.98e-2],
    [1.13e-5,7.55e-6,7.23e-6,1.05e-5,1.83e-5,4.20e-5,1.45e-4,3.41e-4,7.76e-4,1.69e-3,4.03e-3,1.15e-2,3.88e-2],
    [2.92e-5,1.78e-5,1.68e-5,2.64e-5,5.72e-5,1.46e-4,4.05e-4,1.01e-3,2.34e-3,5.15e-3,1.16e-2,3.05e-2,9.09e-2],
    [7.48e-5,4.31e-5,4.08e-5,7.29e-5,1.84e-4,5.07e-4,1.33e-3,3.05e-3,6.89e-3,1.52e-2,3.34e-2,7.97e-2,2.16e-1],
    [1.86e-4,1.03e-4,1.02e-4,2.01e-4,5.29e-4,1.51e-3,4.16e-3,9.02e-3,1.89e-2,4.15e-2,8.92e-2,1.98e-1,4.92e-1],
    [4.45e-4,2.36e-4,2.43e-4,4.97e-4,1.34e-3,3.88e-3,1.12e-2,2.59e-2,4.86e-2,1.03e-1,2.19e-1,4.61e-1,1.07e0] ,
    [1.02e-3,5.12e-4,5.29e-4,1.11e-3,3.01e-3,8.84e-3,2.62e-2,6.65e-2,1.21e-1,2.37e-1,4.95e-1,1.00   ,2.20]   ,
    [2.24e-3,1.07e-3,1.08e-3,2.26e-3,6.20e-3,1.83e-2,5.51e-2,1.50e-1,2.85e-1,5.09e-1,1.04   ,2.04   ,4.31]   ,
    [4.72e-3,2.16e-3,2.09e-3,4.35e-3,1.19e-2,3.51e-2,1.06e-1,3.03e-1,6.24e-1,1.04   ,2.04   ,3.91   ,8.03]   ,
    [9.53e-3,4.27e-3,3.93e-3,7.99e-3,2.16e-2,6.31e-2,1.91e-1,5.60e-1,1.26   ,2.01   ,3.79   ,7.09   ,1.43]   ,
    [1.84e-2,8.27e-3,7.29e-3,1.42e-2,3.76e-2,1.08e-1,3.24e-1,9.65e-1,2.33   ,3.71   ,6.71   ,1.23   ,2.44]   ,
    [3.39e-2,1.57e-2,1.34e-2,2.48e-2,6.32e-2,1.77e-1,5.25e-1,1.57   ,4.02   ,6.54   ,1.13e1 ,2.03e1 ,4.00e1] ,
    [5.95e-2,2.90e-2,2.42e-2,4.23e-2,1.03e-1,2.81e-1,8.16e-1,2.44   ,6.53   ,1.10e1 ,1.84e1 ,3.24e1 ,6.32e1] ,
    [9.85e-2,5.19e-2,4.33e-2,7.11e-2,1.65e-1,4.33e-1,1.23   ,3.64   ,1.01e1 ,1.78e1 ,2.88e1 ,4.98e1 ,9.68e1] ,
    [1.53e-1,9.00e-2,7.64e-2,1.18e-1,2.60e-1,6.53e-1,1.80   ,5.27   ,1.48e1 ,2.77e1 ,4.38e1 ,7.43e1 ,1.44e2] ,
    [2.19e-1,1.50e-1,1.32e-1,1.94e-1,4.02e-1,9.66e-1,2.57   ,7.41   ,2.11e1 ,4.13e1 ,6.45e1 ,1.08e2 ,2.08e2]],np.float)

# 2d interpolate the profile
z = z*10**(-1.0) # convert to SI
kappa = interp2d(LogRho,Temperature,z,kind='linear',fill_value=None)



lg_rho = [-5.0,  -4.5,  -4.0,  -3.5,  -3.0,  -2.5,  -2.0,  -1.5,  -1.0,  -0.5,  0.0,  0.5,  1.0,  1.5,  2.0,  2.5,   3.0,   3.5,   4.0]
lg_temp = [3.60,3.65,3.70,3.75,3.80,3.85,3.90,3.95,4.00,4.05,4.10,4.15,4.20,4.25,4.30,4.35,4.40,4.45,4.50,4.55,4.60,4.65,4.70,4.75,4.80,4.85,4.90,4.95,5.00,5.05,5.10,5.15,5.20,5.25,5.30,5.35,5.40,5.45,5.50,5.55,5.60,5.65,5.70,5.75,5.80,5.85,5.90,5.95,6.00,6.10,6.20,6.30,6.40,6.50,6.60,6.70,6.80,6.90,7.00,7.10,7.20,7.30,7.40,7.50,7.60,7.70,7.80,7.90,8.00,8.10,8.30,8.50,8.70]
z2 = np.array([
[-2.877,-3.040,-3.233,-3.443,-3.660,-3.874,-4.079,-4.256,-4.374,-4.398,-4.326,-4.182,-3.998,-3.793,-3.577,-3.354,-3.124,-2.889,-2.649],
[-2.177,-2.340,-2.533,-2.743,-2.960,-3.174,-3.379,-3.556,-3.674,-3.698,-3.626,-3.482,-3.298,-3.093,-2.877,-2.654,-2.424,-2.189,-1.949],
[-1.477,-1.640,-1.833,-2.043,-2.260,-2.474,-2.679,-2.856,-2.973,-2.998,-2.926,-2.782,-2.598,-2.393,-2.177,-1.954,-1.724,-1.489,-1.249],
[-0.777,-0.940,-1.133,-1.343,-1.560,-1.774,-1.979,-2.156,-2.273,-2.298,-2.226,-2.082,-1.898,-1.693,-1.477,-1.254,-1.024,-0.789,-0.549],
[-0.576,-0.615,-0.693,-0.813,-0.963,-1.129,-1.294,-1.431,-1.521,-1.535,-1.468,-1.345,-1.175,-0.989,-0.792,-0.585,-0.370,-0.145, 0.085],
[-0.555,-0.554,-0.552,-0.552,-0.568,-0.611,-0.672,-0.729,-0.765,-0.757,-0.700,-0.598,-0.464,-0.308,-0.139, 0.046, 0.240, 0.446, 0.663],
[-0.554,-0.550,-0.540,-0.510,-0.446,-0.349,-0.243,-0.148,-0.071,-0.004, 0.066, 0.151, 0.257, 0.373, 0.505, 0.659, 0.826, 1.006, 1.199],
[-0.552,-0.550,-0.541,-0.514,-0.445,-0.309,-0.095, 0.162, 0.408, 0.603, 0.741, 0.851, 0.943, 1.038, 1.141, 1.258, 1.384, 1.532, 1.701],
[-0.532,-0.541,-0.540,-0.521,-0.462,-0.332,-0.106, 0.215, 0.585, 0.937, 1.210, 1.397, 1.529, 1.631, 1.724, 1.807, 1.911, 2.034, 2.179],
[-0.512,-0.514,-0.517,-0.511,-0.470,-0.361,-0.153, 0.161, 0.561, 1.002, 1.404, 1.724, 1.949, 2.093, 2.197, 2.290, 2.384, 2.488, 2.611],
[-0.509,-0.507,-0.503,-0.491,-0.455,-0.368,-0.193, 0.088, 0.472, 0.926, 1.396, 1.835, 2.173, 2.414, 2.581, 2.705, 2.810, 2.914, 3.030],
[-0.507,-0.504,-0.499,-0.487,-0.451,-0.365,-0.206, 0.041, 0.389, 0.820, 1.316, 1.807, 2.244, 2.597, 2.856, 3.033, 3.173, 3.294, 3.415],
[-0.506,-0.501,-0.495,-0.484,-0.452,-0.376,-0.229, 0.011, 0.343, 0.754, 1.228, 1.734, 2.223, 2.670, 3.029, 3.287, 3.473, 3.627, 3.764],
[-0.506,-0.500,-0.490,-0.477,-0.448,-0.382,-0.250,-0.027, 0.303, 0.719, 1.190, 1.679, 2.183, 2.684, 3.126, 3.473, 3.727, 3.922, 4.085],
[-0.507,-0.500,-0.487,-0.468,-0.438,-0.378,-0.260,-0.052, 0.268, 0.687, 1.172, 1.670, 2.173, 2.690, 3.182, 3.606, 3.930, 4.177, 4.370],
[-0.504,-0.500,-0.486,-0.461,-0.424,-0.363,-0.254,-0.058, 0.252, 0.677, 1.169, 1.681, 2.198, 2.718, 3.238, 3.712, 4.096, 4.398, 4.623],
[-0.483,-0.488,-0.481,-0.455,-0.409,-0.342,-0.233,-0.042, 0.266, 0.688, 1.174, 1.697, 2.234, 2.769, 3.308, 3.811, 4.239, 4.584, 4.840],
[-0.470,-0.469,-0.462,-0.440,-0.391,-0.315,-0.200,-0.007, 0.301, 0.723, 1.214, 1.741, 2.285, 2.835, 3.392, 3.914, 4.372, 4.741, 5.033],
[-0.469,-0.466,-0.456,-0.427,-0.367,-0.274,-0.145, 0.050, 0.359, 0.784, 1.278, 1.806, 2.350, 2.913, 3.482, 4.018, 4.495, 4.885, 5.192],
[-0.469,-0.466,-0.457,-0.432,-0.369,-0.248,-0.078, 0.146, 0.458, 0.874, 1.363, 1.888, 2.430, 2.993, 3.565, 4.110, 4.595, 4.996, 5.307],
[-0.469,-0.467,-0.460,-0.439,-0.384,-0.267,-0.066, 0.222, 0.577, 0.992, 1.465, 1.979, 2.514, 3.068, 3.633, 4.175, 4.659, 5.058, 5.363],
[-0.469,-0.467,-0.462,-0.445,-0.398,-0.293,-0.101, 0.205, 0.619, 1.086, 1.565, 2.062, 2.583, 3.121, 3.666, 4.193, 4.667, 5.058, 5.352],
[-0.469,-0.467,-0.462,-0.449,-0.410,-0.318,-0.142, 0.145, 0.549, 1.044, 1.572, 2.092, 2.606, 3.127, 3.651, 4.158, 4.617, 5.000, 5.288],
[-0.469,-0.466,-0.461,-0.450,-0.417,-0.338,-0.181, 0.081, 0.457, 0.925, 1.455, 2.010, 2.555, 3.079, 3.591, 4.082, 4.531, 4.910, 5.199],
[-0.469,-0.466,-0.460,-0.448,-0.420,-0.352,-0.214, 0.025, 0.374, 0.817, 1.324, 1.872, 2.439, 2.988, 3.506, 3.995, 4.439, 4.815, 5.102],
[-0.469,-0.467,-0.460,-0.446,-0.418,-0.358,-0.235,-0.018, 0.309, 0.735, 1.227, 1.760, 2.323, 2.883, 3.420, 3.918, 4.364, 4.736, 5.016],
[-0.470,-0.468,-0.461,-0.446,-0.416,-0.357,-0.243,-0.044, 0.266, 0.682, 1.166, 1.692, 2.243, 2.803, 3.353, 3.863, 4.312, 4.675, 4.940],
[-0.470,-0.468,-0.463,-0.448,-0.416,-0.354,-0.243,-0.053, 0.247, 0.656, 1.136, 1.659, 2.204, 2.761, 3.315, 3.831, 4.279, 4.626, 4.870],
[-0.470,-0.469,-0.465,-0.452,-0.420,-0.354,-0.239,-0.050, 0.248, 0.654, 1.132, 1.655, 2.197, 2.751, 3.304, 3.817, 4.253, 4.575, 4.793],
[-0.470,-0.469,-0.466,-0.456,-0.427,-0.361,-0.240,-0.043, 0.256, 0.663, 1.145, 1.667, 2.208, 2.757, 3.300, 3.800, 4.213, 4.504, 4.698],
[-0.470,-0.470,-0.467,-0.459,-0.435,-0.374,-0.252,-0.046, 0.263, 0.676, 1.158, 1.677, 2.211, 2.751, 3.277, 3.753, 4.136, 4.400, 4.579],
[-0.470,-0.470,-0.468,-0.462,-0.442,-0.389,-0.273,-0.066, 0.249, 0.665, 1.145, 1.656, 2.178, 2.701, 3.203, 3.652, 4.011, 4.262, 4.439],
[-0.470,-0.470,-0.469,-0.463,-0.448,-0.403,-0.299,-0.102, 0.206, 0.613, 1.083, 1.580, 2.087, 2.589, 3.069, 3.499, 3.847, 4.101, 4.288],
[-0.471,-0.470,-0.469,-0.465,-0.452,-0.416,-0.326,-0.148, 0.137, 0.520, 0.969, 1.449, 1.940, 2.428, 2.894, 3.316, 3.663, 3.929, 4.132],
[-0.471,-0.470,-0.469,-0.466,-0.456,-0.426,-0.350,-0.196, 0.058, 0.407, 0.826, 1.287, 1.765, 2.243, 2.703, 3.123, 3.476, 3.757, 3.978],
[-0.471,-0.471,-0.470,-0.467,-0.459,-0.434,-0.371,-0.241,-0.021, 0.291, 0.678, 1.118, 1.585, 2.057, 2.513, 2.935, 3.296, 3.592, 3.829],
[-0.471,-0.471,-0.470,-0.468,-0.461,-0.441,-0.389,-0.279,-0.091, 0.183, 0.539, 0.957, 1.412, 1.878, 2.334, 2.757, 3.126, 3.436, 3.683],
[-0.471,-0.471,-0.470,-0.468,-0.463,-0.446,-0.403,-0.312,-0.152, 0.090, 0.414, 0.810, 1.252, 1.712, 2.166, 2.592, 2.969, 3.289, 3.544],
[-0.471,-0.471,-0.470,-0.469,-0.464,-0.450,-0.415,-0.338,-0.202, 0.010, 0.306, 0.679, 1.106, 1.560, 2.012, 2.439, 2.824, 3.150, 3.415],
[-0.471,-0.471,-0.470,-0.469,-0.465,-0.454,-0.424,-0.360,-0.243,-0.056, 0.213, 0.563, 0.975, 1.420, 1.870, 2.299, 2.691, 3.021, 3.294],
[-0.471,-0.471,-0.471,-0.469,-0.466,-0.457,-0.432,-0.378,-0.277,-0.112, 0.134, 0.461, 0.857, 1.293, 1.740, 2.171, 2.566, 2.899, 3.184],
[-0.471,-0.471,-0.471,-0.470,-0.467,-0.459,-0.438,-0.392,-0.305,-0.158, 0.066, 0.372, 0.751, 1.178, 1.620, 2.052, 2.450, 2.786, 3.086],
[-0.471,-0.471,-0.471,-0.470,-0.468,-0.461,-0.443,-0.404,-0.328,-0.196, 0.008, 0.295, 0.657, 1.073, 1.510, 1.943, 2.340, 2.682, 3.000],
[-0.471,-0.471,-0.471,-0.470,-0.468,-0.462,-0.447,-0.413,-0.346,-0.229,-0.041, 0.227, 0.572, 0.977, 1.409, 1.842, 2.238, 2.587, 2.923],
[-0.471,-0.471,-0.471,-0.470,-0.469,-0.464,-0.450,-0.421,-0.362,-0.256,-0.084, 0.167, 0.496, 0.889, 1.316, 1.747, 2.142, 2.498, 2.849],
[-0.471,-0.471,-0.471,-0.471,-0.469,-0.465,-0.453,-0.427,-0.375,-0.279,-0.121, 0.114, 0.428, 0.809, 1.231, 1.657, 2.052, 2.417, 2.775],
[-0.471,-0.471,-0.471,-0.471,-0.469,-0.466,-0.456,-0.433,-0.386,-0.299,-0.153, 0.067, 0.367, 0.736, 1.151, 1.572, 1.969, 2.342, 2.706],
[-0.472,-0.471,-0.471,-0.471,-0.470,-0.466,-0.458,-0.437,-0.395,-0.316,-0.181, 0.026, 0.312, 0.670, 1.077, 1.493, 1.891, 2.274, 2.644],
[-0.472,-0.472,-0.471,-0.471,-0.470,-0.467,-0.459,-0.441,-0.403,-0.330,-0.205,-0.011, 0.261, 0.607, 1.008, 1.418, 1.819, 2.210, 2.588],
[-0.472,-0.472,-0.472,-0.471,-0.471,-0.468,-0.463,-0.448,-0.417,-0.356,-0.248,-0.076, 0.173, 0.498, 0.878, 1.282, 1.689, 2.091, 2.490],
[-0.472,-0.472,-0.472,-0.472,-0.471,-0.469,-0.465,-0.453,-0.427,-0.375,-0.280,-0.127, 0.100, 0.404, 0.763, 1.163, 1.577, 1.988, 2.392],
[-0.473,-0.473,-0.473,-0.472,-0.472,-0.471,-0.467,-0.457,-0.435,-0.390,-0.307,-0.169, 0.039, 0.319, 0.664, 1.059, 1.475, 1.894, 2.293],
[-0.473,-0.473,-0.473,-0.473,-0.473,-0.472,-0.468,-0.460,-0.441,-0.402,-0.329,-0.205,-0.014, 0.245, 0.578, 0.969, 1.385, 1.805, 2.183],
[-0.474,-0.474,-0.474,-0.474,-0.473,-0.473,-0.470,-0.463,-0.447,-0.413,-0.348,-0.235,-0.062, 0.183, 0.505, 0.886, 1.303, 1.711, 2.073],
[-0.475,-0.475,-0.475,-0.474,-0.474,-0.474,-0.471,-0.466,-0.451,-0.421,-0.363,-0.261,-0.104, 0.122, 0.429, 0.810, 1.222, 1.615, 1.958],
[-0.476,-0.476,-0.476,-0.476,-0.475,-0.475,-0.473,-0.468,-0.456,-0.429,-0.377,-0.285,-0.141, 0.076, 0.375, 0.740, 1.140, 1.517, 1.844],
[-0.477,-0.477,-0.477,-0.477,-0.477,-0.476,-0.475,-0.470,-0.460,-0.436,-0.389,-0.308,-0.173, 0.034, 0.317, 0.673, 1.056, 1.416, 1.726],
[-0.478,-0.478,-0.478,-0.478,-0.478,-0.478,-0.477,-0.473,-0.464,-0.443,-0.401,-0.328,-0.203,-0.007, 0.264, 0.604, 0.971, 1.310, 1.585],
[-0.480,-0.480,-0.480,-0.481,-0.481,-0.480,-0.479,-0.476,-0.468,-0.449,-0.412,-0.346,-0.229,-0.046, 0.212, 0.535, 0.884, 1.202, 1.455],
[-0.483,-0.483,-0.483,-0.483,-0.483,-0.483,-0.482,-0.479,-0.472,-0.455,-0.424,-0.362,-0.251,-0.083, 0.159, 0.464, 0.797, 1.087, 1.279],
[-0.486,-0.486,-0.486,-0.486,-0.486,-0.486,-0.485,-0.483,-0.476,-0.462,-0.433,-0.376,-0.276,-0.119, 0.105, 0.393, 0.696, 0.961, 0.0  ],
[-0.490,-0.490,-0.490,-0.490,-0.490,-0.490,-0.489,-0.487,-0.482,-0.470,-0.444,-0.390,-0.300,-0.157, 0.050, 0.312, 0.607, 0.0,   0.0  ],
[-0.495,-0.495,-0.495,-0.495,-0.495,-0.495,-0.494,-0.493,-0.488,-0.478,-0.454,-0.406,-0.325,-0.197,-0.007, 0.234, 0.505, 0.0,   0.0  ],
[-0.501,-0.501,-0.501,-0.501,-0.501,-0.501,-0.501,-0.499,-0.495,-0.486,-0.464,-0.422,-0.351,-0.238,-0.070, 0.157, 0.0,   0.0,   0.0  ],
[-0.508,-0.508,-0.508,-0.508,-0.509,-0.509,-0.508,-0.507,-0.504,-0.496,-0.476,-0.440,-0.380,-0.283,-0.134, 0.071, 0.0,   0.0,   0.0  ],
[-0.518,-0.518,-0.518,-0.518,-0.518,-0.518,-0.518,-0.517,-0.515,-0.507,-0.490,-0.460,-0.412,-0.330,-0.202,-0.020, 0.0,   0.0,   0.0  ],
[-0.530,-0.530,-0.530,-0.530,-0.530,-0.530,-0.530,-0.529,-0.528,-0.521,-0.507,-0.484,-0.447,-0.382,-0.275,-0.128, 0.0,   0.0,   0.0  ],
[-0.544,-0.544,-0.544,-0.544,-0.545,-0.545,-0.545,-0.545,-0.543,-0.537,-0.527,-0.511,-0.487,-0.440,-0.352, 0.0,   0.0,   0.0,   0.0  ],
[-0.560,-0.560,-0.560,-0.560,-0.560,-0.561,-0.561,-0.561,-0.559,-0.554,-0.548,-0.540,-0.529,-0.500,-0.433, 0.0,   0.0,   0.0,   0.0  ],
[-0.580,-0.580,-0.580,-0.580,-0.580,-0.580,-0.581,-0.581,-0.579,-0.576,-0.574,-0.574,-0.577,-0.566,-0.526, 0.0,   0.0,   0.0,   0.0  ],
[-0.633,-0.633,-0.633,-0.633,-0.634,-0.634,-0.634,-0.634,-0.633,-0.634,-0.640,-0.659,-0.690,-0.716,-0.733, 0.0,   0.0,   0.0,   0.0  ],
[-0.704,-0.704,-0.704,-0.704,-0.704,-0.704,-0.704,-0.704,-0.705,-0.710,-0.726,-0.764,-0.807,-0.927,-1.275, 0.0,   0.0,   0.0,   0.0  ],
[-0.582,-0.753,-0.785,-0.789,-0.789,-0.789,-0.789,-0.789,-0.792,-0.801,-0.828,-0.886,-0.969,-1.061, 0.0,   0.0,   0.0,   0.0,   0.0  ]],np.float)

#2d interpolate the profile again
kappa2 = interp2d(lg_rho,lg_temp,z2,kind='linear',fill_value=None)

def opac(log_rho,temp):
    if temp >= 1000.0 and temp <= 7000.0:
        return kappa(log_rho,temp)
    elif temp > 7000.0:
        lg_opac = kappa2(log_rho,np.log10(temp))
        opaci = 10**(-1.0)*10**(lg_opac)
        return opaci
    else:
        return np.nan

# def opac2(log_rho2,temp):
#     lg_opac = kappa2(log_rho2,np.log10(temp))
#     opaci = 10**(-1.0)*10**(lg_opac)
#     return opaci
#,test,the,function
#print(kappa(-5.0,3200))

#and log_rho >= -9.0 and log_rho <= 2.7
# and log_rho >= -5.0 and log_rho <= 4.0